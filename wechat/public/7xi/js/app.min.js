function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!==i?unescape(i[2]):null}function _isIos(){var e=navigator.userAgent,t=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return t?!0:!1}function talkObj(){this.url={home:"index.html",money:"money.html",register:"register.html",game:"game.html",lists:"lists.html"},this.content={score:["label-score-1.png","label-score-7.png","label-score-2.png","label-score-5.png","label-score-4.png"],shareTitle:"秀恩爱Si得快，拆散一对赚一块！",shareDesc:"过什么七夕？！来帮我赚钱！",wxInitUrl:"/serve/jssign",shareImg:"https://weixin.souyidai.com/7xi/res/goutou2.jpg",shareUrl:"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx5ff6c76bdf3b5cce&redirect_uri=http%3A%2F%2Fweixin.souyidai.com%2Foauth%2F&response_type=code&scope=snsapi_userinfo&state=7xi{1}#wechat_redirect",shareOk:"分享成功",shareClose:"分享取消",cantPlay:"今天你的机会已经用完了，明天再来吧",cantPlayHelp:"今天帮他的机会已经用完了，明天再来吧",regPhoneNull:"请输入手机号码!",regCaptchaNull:"请输入验证码!",regCaptchaError:"验证码不正确!",regPhoneError:"您的手机号码不正确!",regPhoneCaptchaNull:"请输入手机验证码!",regPhoneCaptchaError:"手机号码验证错误!",regPwNull:"请输入搜易贷登录密码!",regPwMinSize:"登录密码长度不可少于6位!",regClause:"请勾选搜易贷在线服务协议!",maxMoney:"每日累计兑换奖励金额为88元红包，当前申请的兑换额度已超出总额。您今日还可再兑换{1}元红包。",toDayUse:"今日兑换已用完，明天再来吧。",notMoneyYou:"0分？今天太背了！快去邀请朋友来帮你玩",notFriendHelpYou:"今天还没有朋友帮你哦，快找人来帮你赚钱啦！",cashOk:"兑换成功！",notMoney:"你当前的余额是0哦！",taskGame:"* 每人每天只能“兑换”一次自己的分数奖励哦。\n  对目前分数不满意，可以“重玩”！"},this.loves=[{lovers:!0,role:[{key:"role/f1.png",x:100,y:-20,direction:1},{key:"role/1.png",x:0,y:0,direction:0}]},{lovers:!0,role:[{key:"role/2.png",x:0,y:0,direction:0},{key:"role/f2.png",x:100,y:-20,direction:1}]},{lovers:!1,role:[{key:"role/3.png",x:0,y:0,direction:0},{key:"role/5.png",x:150,y:0,direction:1}]},{lovers:!0,role:[{key:"role/4.png",x:0,y:0,direction:0},{key:"role/f3.png",x:60,y:0,direction:1}]},{lovers:!1,role:[{key:"role/f4.png",x:0,y:0,direction:0},{key:"role/f5.png",x:180,y:0,direction:1}]}],this.tipsClear=null}function setShare(){var e="";if(arguments[0]){var t="_help_"+arguments[0];e=talk.get("shareUrl",t)}else e=talk.get("shareUrl","");var i=arguments[1]?arguments[1]:talk.get("shareTitle"),s=arguments[2]?arguments[2]:talk.get("shareImg"),r=arguments[3]?arguments[3]:talk.get("shareDesc"),o={title:i,link:e,imgUrl:s,desc:r,success:function(){_paq.push(["trackEvent","7xi","share","success"]),talk.tips("shareOk")},cancel:function(){talk.tips("shareClose")}};wx.ready(function(){wx.onMenuShareTimeline(o),wx.onMenuShareAppMessage(o)})}function api(e,t,i){this.url={user:{url:"/event/c/user/show",method:"GET",dataType:"json",data:t},reward:{url:"/event/c/user/reward",method:"GET",dataType:"json",data:t},reward_post:{url:"/event/c/user/reward",method:"POST",dataType:"json",data:t},list:{url:"/event/c/user/reward/list",method:"GET",dataType:"json",data:t},verify:{url:"/event/c/user/bind",method:"POST",dataType:"json",data:t},register:{url:"/event/c/user/reg",method:"POST",dataType:"json",data:t},user_game_log:{url:"/event/c/user/play",method:"POST",dataType:"json",data:t},reCaptcha:{url:"/event/c/user/resend",method:"POST",dataType:"json",data:t}},$.ajax(this.url[e]).done(i).fail(function(e,t){alert("Request failed: "+t)})}function registerObj(){this.reSendCountDown=null,this.isReCaptcha=!1,this.clause=!0,this.isVerifyIng=0,this.isRegisterIng=0}function RewardsObj(){this.maxMoney=88,this.cashType=1,this.cashMoney=0}function RewardsListObj(){this.lists=[]}var gigoloKnit={},user={},isIos=_isIos();talkObj.prototype={get:function(){var e=arguments;"object"==typeof e[0]&&(e=e[0]);var t=this.content[e[0]];if(1==e.length)return t;for(var i=1;i<e.length;i++){var s=new RegExp("\\{"+i+"\\}","gm");t=t.replace(s,e[i])}return t},tips:function(){var e=this.get(arguments);$(".tips").length||$("body").append('<div class="tips"><div class="tips-warp"><span></span></div></div>'),$(".tips span").text(e),$(".tips").show(),clearTimeout(this.tipsClear),this.tipsClear=setTimeout(function(){$(".tips").hide()},2e3)}};var talk=new talkObj;$.ajax({url:talk.get("wxInitUrl"),type:"GET",dataType:"json",data:{url:location.href},success:function(e){0===e.errorCode&&wx.config(e.result)}}),gigoloKnit.boot={preload:function(){this.load.image("preloaderBarEye","./res/bg-eye.png"),this.load.image("preloaderBarBg","./res/loading-kuang.png"),this.load.image("preloaderBarLine","./res/loading-jiazai.png"),this.load.image("loadingEnd","./res/loading-end.png")},create:function(e){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.state.start("preloader"),isIos||(this.time.desiredFps=40)}},gigoloKnit.gameNozzle=function(e){gigoloKnit.score=0,gigoloKnit.time=18,gigoloKnit.musicState=!0,gigoloKnit.scoreText=null,gigoloKnit.timeText=null,gigoloKnit.musicBtn=null,gigoloKnit.soundTmd=null,gigoloKnit.soundYy=null,this.font={fontSize:"60px",fill:"#000"},this.init=function(){gigoloKnit.score=0,gigoloKnit.time=18,this.add.image(0,this.world.height-457,"img","bg-fangzi.png"),this.add.image(this.world.centerX,this.world.height-170,"img","label-score.png").anchor.setTo(.5,0),this.add.image(65,90,"img","label-time.png"),gigoloKnit.musicBtn=this.add.sprite(this.world.width-132-80,50,"img","music-on.png"),gigoloKnit.musicBtn.inputEnabled=!0,gigoloKnit.musicBtn.events.onInputDown.add(this.musicSwitch,this),gigoloKnit.soundTmd=this.add.audio("sound-ymd"),gigoloKnit.soundYy=this.add.audio("sound-yy"),gigoloKnit.scoreText=this.add.text(600,this.world.height-130,gigoloKnit.score,this.font),gigoloKnit.timeText=this.add.text(255,84,gigoloKnit.time,this.font)},this.musicSwitch=function(e){gigoloKnit.musicState=!gigoloKnit.musicState,gigoloKnit.musicState?gigoloKnit.musicBtn.loadTexture("img","music-on.png"):gigoloKnit.musicBtn.loadTexture("img","music-off.png")},this.setScore=function(){}},gigoloKnit.game=function(e){gigoloKnit.gameNozzle.call(this),this._loversGroup=null,this._marksGroup=null,this._spawnLoversTimer=0,this._spawnLoversSpeed=1e3,this._spawnLoversSpeedYAndroid=20,this.slashes=null,this.points=[]},gigoloKnit.game.prototype={create:function(e){this._spawnLoversTimer=0,this._spawnLoversSpeed=1e3,this._spawnLoversSpeedYAndroid=20,isIos&&(this.physics.startSystem(Phaser.Physics.ARCADE),this.physics.arcade.gravity.y=1500),this._loversGroup=this.add.group(),this._marksGroup=this.add.group(),this.spawnLovers(),this.time.events.loop(1e3,this.updateTime,this)},update:function(e){this._spawnLoversTimer+=this.time.elapsed,this._spawnLoversTimer>this._spawnLoversSpeed&&this._loversGroup.length<3&&(this._spawnLoversTimer=0,this.spawnLovers(),this._spawnLoversSpeed-=30,this.physics.arcade.gravity.y+=180),this._loversGroup.forEach(function(e){if(!isIos){if(e.state.kill)return this._loversGroup.remove(e),e.kill(),!1;e.y+=this._spawnLoversSpeedYAndroid}(e.y>gigoloKnit.GAME_HEIGHT||e.x>gigoloKnit.GAME_WIDTH||e.x<0)&&(e.state.lovers&&!e.state.kill&&gigoloKnit.score>0&&(gigoloKnit.score--,this.setScoreText(),e.state.kill=!0),this._loversGroup.remove(e),e.kill()),isIos&&e.state.kill&&(e.state.countdownToDeath--,e.state.countdownToDeath<=0?0===e.direction?(e.angle-=15,e.x-=10):(e.angle+=15,e.x+=10):0===e.direction?(e.angle-=2,e.x-=7):(e.angle+=2,e.x+=7))},this),this._marksGroup&&this._marksGroup.forEach(function(e){e.alpha<=.1?(this._marksGroup.remove(e),e.kill()):(e.alpha-=.03,e.y-=10)},this)},updateTime:function(){gigoloKnit.time<=0?this.gameOver():(gigoloKnit.time--,gigoloKnit.timeText.setText(gigoloKnit.time))},gameOver:function(){this.pausedText=this.add.text(this.world.centerX,this.world.centerY-300,"游戏结束",{font:"90px Arial",fill:"#68d1ef",strokeThickness:5,align:"center"}).anchor.setTo(.5,.5),this.game.paused=!0,gigoloKnit.score<0&&(gigoloKnit.score=0),user.money=gigoloKnit.score;var e=this;setTimeout(function(){e.game.paused=!1,e.state.start("scoreState")},1e3)},spawnLovers:function(e){this._spawnLoversSpeedYAndroid+=1;var t=Math.floor(Math.random()*gigoloKnit.GAME_WIDTH);t>gigoloKnit.GAME_WIDTH-400?t=gigoloKnit.GAME_WIDTH-400:200>t&&(t=200);var i=0,s=Math.floor(10*Math.random());i=s>=5?[0,1,3][Math.floor(3*Math.random())]:[2,4][Math.floor(2*Math.random())],gigoloKnit.score>11&&(i=[2,4][Math.floor(2*Math.random())]);for(var r=talk.loves[i],o={kill:!1,lovers:r.lovers,countdownToDeath:20},n=-200,a=t,l=0;2>l;l++){var h=r.role[l],d=this.add.sprite(a+h.x,n+h.y,"img",h.key);d.state=o,d.direction=h.direction,isIos&&this.physics.enable(d,Phaser.Physics.ARCADE),d.inputEnabled=!0,d.events.onInputDown.add(this.clickLovers,this),d.anchor.setTo(.5,.5),this._loversGroup.add(d)}},clickLovers:function(e){if(e.state.kill)return!1;e.state.kill=!0;var t="label-plus.png";e.state.lovers?gigoloKnit.score+=1:(gigoloKnit.score>0&&(gigoloKnit.score-=1),t="label-dim.png");var i=this.add.sprite(e.x-100,e.y-100,"img",t);i.anchor.setTo(.5,.5),i.alpha=1,this._marksGroup.add(i),this.setScoreText(),this.playAudio(e.state.lovers)},setScoreText:function(){gigoloKnit.scoreText.setText(gigoloKnit.score)},playAudio:function(e){gigoloKnit.musicState&&(e?gigoloKnit.soundTmd.play():gigoloKnit.soundYy.play())}},gigoloKnit.preloader=function(e){this.progress=0},gigoloKnit.preloader.prototype={preload:function(e){e.load.onFileComplete.add(function(e,t){100===e&&this.startMenu()},this),e.stage.backgroundColor=gigoloKnit.BACKGROUND,this.preloaderBarEye=this.add.sprite(this.world.centerX,this.world.centerY-300,"preloaderBarEye"),this.preloaderBarEye.anchor.setTo(.5,.5),this.preloaderBarBg=this.add.sprite(this.world.centerX,this.world.centerY,"preloaderBarBg"),this.preloaderBarBg.anchor.setTo(.5,0),this.preloaderBarLine=this.add.sprite(this.world.centerX-162,this.world.centerY,"preloaderBarLine"),e.load.setPreloadSprite(this.preloaderBarLine);this.load.atlas("img","res/images.png","res/images.json");this.load.audio("sound-ymd","./res/ymd.mp3"),this.load.audio("sound-yy","./res/yy.mp3"),this.load.audio("sound-321readygo","./res/321readygo.mp3"),this.loadUserInfo()},create:function(){this.preloaderBarBg.kill(),this.preloaderBarLine.kill(),this.add.image(this.world.centerX,this.world.centerY,"loadingEnd").anchor.setTo(.5,.5)},startMenu:function(){100==this.load.progress&&100==this.progress&&this.state.start("readyGo")},loadUserInfo:function(){var e=this,t=this.game.net.getQueryString("friend_uid");"object"!=typeof t?(user.friend_uid=t,user.is_help=1):user.is_help=0,api("user",user,function(t){0===t.errorCode?(user=$.extend(user,t.data),setShare(user.uid),user.is_help?(e.load.image("picture-friend",user.friend_picture),e.load.image("picture",user.picture),user.count_help||(talk.tips("cantPlayHelp"),window.location.href=talk.url.home)):user.count_play||(talk.tips("cantPlay"),window.location.href=talk.url.home)):alert(t.errorMessage),e.progress=100,e.startMenu()})}},gigoloKnit.readyGo=function(e){this._readyGoTime=3,this._countdown=null},gigoloKnit.readyGo.prototype={create:function(e){this.add.image(0,this.world.height-457,"img","bg-fangzi.png"),this.add.image(this.world.centerX,this.world.height-170,"img","label-score.png").anchor.setTo(.5,0),this.add.image(65,90,"img","label-time.png"),gigoloKnit.musicBtn=this.add.sprite(this.world.width-132-80,50,"img","music-on.png"),this.graphics=this.add.graphics(0,0),this.graphics.beginFill(0),this.graphics.alpha=.9,this.graphics.drawRect(0,0,gigoloKnit.GAME_WIDTH,gigoloKnit.GAME_HEIGHT),this.plus=this.add.sprite(this.world.centerX+0,this.world.centerY-650,"img","label-plus.png"),this.guide1=this.add.sprite(this.world.centerX,this.world.centerY-390,"img","label-guide-1.png"),this.guide1.angle=-20,this.dim=this.add.sprite(this.world.centerX-80,this.world.centerY+200,"img","label-dim.png"),this.guide2=this.add.sprite(this.world.centerX-450,this.world.centerY+250,"img","label-guide-2.png"),this.guide2.angle=20,this._loversGroup=this.add.group(),this._x=this.world.centerX-250,this._y=this.world.centerY-500,this.spawnLovers(3),this._x=this.world.centerX+250,this._y=this.world.centerY+400,this.spawnLovers(2),this.hand=this.add.sprite(this.world.centerX-160,this.world.centerY-360,"img","bg-hand.png"),this.hand.anchor.setTo(.5,.5),this.hand.angle=10,_paq.push(["trackEvent","7xi","game","play"])},loopStart:function(){this._readyGoTime=3,this._countdown=this.add.sprite(this.world.centerX,this.world.centerY-300,"img",this._readyGoTime+".png"),this._countdown.anchor.setTo(.5,0);this.time.events.loop(700,this.updateCounter,this);gigoloKnit.soundReadygo=this.add.audio("sound-321readygo"),gigoloKnit.soundReadygo.play()},update:function(e){this._loversGroup.forEach(function(e){if((e.y>gigoloKnit.GAME_HEIGHT||e.x>gigoloKnit.GAME_WIDTH||e.x<0)&&this._loversGroup.removeAll(),e.state.kill){0===e.direction&&(e.angle-=15,e.x-=10,e.y+=10),1===e.direction&&(e.angle+=15,e.x+=10,e.y+=10);var t=this.dim;e.state.lovers&&(t=this.plus),t.alpha<=.1?t.kill():(t.y-=5,t.alpha-=.03)}this._loversGroup.length||(this.graphics.kill(),this.guide1.kill(),this.guide2.kill(),this.plus.kill(),this.dim.kill(),this.loopStart())},this),this.hand.visible&&(this.hand.x<=380?this.cc=10:this.hand.x>=500&&(this.cc=-10),this.hand.x+=this.cc,this.hand.y+=this.cc)},spawnLovers:function(e){for(var t=talk.loves[e],i={kill:!1,lovers:t.lovers},s=0;2>s;s++){var r=t.role[s],o=this.add.sprite(this._x+r.x-20,this._y+r.y-20,"img",r.key);o.inputEnabled=!0,o.events.onInputDown.add(this.clickLovers,this),o.anchor.setTo(.5,.5),o.direction=r.direction,o.state=i,this._loversGroup.add(o)}},clickLovers:function(e){e.state.kill=!0,this.hand.kill()},updateCounter:function(){this._readyGoTime--,this._readyGoTime>0?this._countdown.loadTexture("img",this._readyGoTime+".png"):this.state.start("game")}},gigoloKnit.ruleGame=function(e){this.font={font:"45px Arial",fill:"#000",align:"left",boundsAlignH:"center",boundsAlignV:"middle"}},gigoloKnit.ruleGame.prototype={create:function(e){this.add.image(this.world.centerX-10,620,"img","label-game-of-rule.png").anchor.setTo(.5,0),this.add.image(this.world.centerX-10,150,"img","label-game-of-time.png").anchor.setTo(.5,0),this.add.button(gigoloKnit.GAME_WIDTH-120,16,"img",this.close,this,"cha.png","cha.png"),this.add.text(150,380,talk.get("campaignTime"),this.font),this.add.text(150,850,talk.get("ruleGame"),this.font)},close:function(){this.state.start("menu")}},gigoloKnit.scoreState=function(e){this.font={font:"85px Arial",fill:"#000",boundsAlignH:"center",boundsAlignV:"middle"}},gigoloKnit.scoreState.prototype={create:function(e){if(this.add.image(this.world.centerX,250,"img","bg-eye.png").anchor.setTo(.5,.5),user.is_help)this.add.image(this.world.centerX,400,"img","label-tag.png").anchor.setTo(.5,.5),this.add.image(this.world.centerX,590,"img","label-think.png").anchor.setTo(.5,.5),this.add.image(this.world.centerX,860,"img","label-help-success.png").anchor.setTo(.5,.5),this.add.image(this.world.centerX,1020,"img","label-m.png").anchor.setTo(.5,.5),this.picture=this.add.image(this.world.centerX-300,850,"picture"),this.picture.anchor.setTo(.5,.5),this.picture.width=150,this.picture.height=150,this.friendPicture=this.add.image(this.world.centerX+300,850,"picture-friend"),this.friendPicture.anchor.setTo(.5,.5),this.friendPicture.width=150,this.friendPicture.height=150,this.add.text(this.world.centerX+33,1023,gigoloKnit.score,this.font).anchor.setTo(.5,.5),this.add.button(this.world.centerX,this.world.centerY+450,"img",this.againByMe,this,"btn-by-me.png","btn-by-me.png").anchor.setTo(.5,.5),this.submitUserLog();else{var t=Math.floor(5*Math.random());this.add.image(this.world.centerX,400,"img",talk.get("score")[t]).anchor.setTo(.5,.5),this.add.image(this.world.centerX,650,"img","label-money.png").anchor.setTo(.5,.5),this.add.text(this.world.centerX+185,655,gigoloKnit.score,this.font).anchor.setTo(.5,.5),this.add.button(50,1e3,"img",this.again,this,"btn-again.png","btn-again.png"),this.add.button(gigoloKnit.GAME_WIDTH-500,1e3,"img",this.moneyState,this,"btn-money.png","btn-money.png"),this.add.text(60,1250,talk.get("taskGame"),{font:"40px Arial",fill:"#000",boundsAlignH:"center",boundsAlignV:"middle"})}},moneyState:function(){api("user_game_log",user,function(e){0===e.errorCode?window.location.href=talk.url.register:alert(e.errorMessage)})},submitUserLog:function(){api("user_game_log",user,function(e){0===e.errorCode||alert(e.errorMessage)})},again:function(){this.state.start("readyGo")},againByMe:function(){window.location.href=talk.url.home},closeMouse:function(){this.graphics.kill(),this.role.kill()}};var homeHelpObj=function(){this.setText=function(){$(".friend-play-count").text(user.count_help),$(".friend-picture").attr("src",user.friend_picture),$(".friend-username").text(user.friend_username),user.count_help||$(".btn-by-me").addClass("not-play")},this.bind=function(){$(".btn-share").click(this.showShare),$("#shareState").click(this.hideShare),$(".btn-rule").click(this.showRole),$(".btn-close").click(this.hideRole),$(".btn-start").click(this.playGameByHelp),$(".btn-by-me").click(this.playGame)},this.playGameByHelp=function(){user.count_help?window.location.href=talk.url.game+"?friend_uid="+user.friend_uid:talk.tips("cantPlayHelp")},this.playGame=function(){window.location.href=talk.url.home},this.update=function(){this.setText(),this.bind()}},homeSelfObj=function(){this.setText=function(){},this.bind=function(){$(".btn-share").click(this.showShare),$("#shareState").click(this.hideShare),$(".btn-rule").click(this.showRole),$(".btn-close").click(this.hideRole),$(".btn-start").click(this.playGame)},this.showShare=function(){_paq.push(["trackEvent","7xi","share","start"]),$("#shareState").show()},this.hideShare=function(){$("#shareState").hide()},this.showRole=function(){$("#roleState").show()},this.hideRole=function(){$("#roleState").hide()},this.playGame=function(){user.count_play?window.location.href=talk.url.game:talk.tips("cantPlay")},this.update=function(){this.setText(),this.bind(),rewardsList.init()}},homeObj=function(){};homeObj.prototype={init:function(){user.is_help=0;var e=getQueryString("friend_uid");e&&(user.friend_uid=e,user.is_help=1),user.is_help?(homeHelpObj.call(this),$(".by-friend").show()):(homeSelfObj.call(this),$(".by-me").show()),this.loadRewardInfo()},loadRewardInfo:function(){api("user",user,function(e){0===e.errorCode?(user=$.extend(user,e.data),home.update(),setShare(user.uid)):alert(e.errorMessage)})}};var home=new homeObj;registerObj.prototype={init:function(){this.bind(),user.type=1;var e=getQueryString("cashType");e&&"2"==e&&(user.type=2),api("user",{is_help:0},function(e){0===e.errorCode?(user=$.extend(user,e.data),setShare(user.uid)):alert(e.errorMessage)})},bind:function(){$(".input-reset input").on("input",function(){$(".input-captcha").removeClass("error"),$(this).val()?$(this).next(".input-reset-btn").show():$(this).next(".input-reset-btn").hide()}),$(".input-reset input").on("focus",function(){$(this).val()?$(this).next(".input-reset-btn").show():$(this).next(".input-reset-btn").hide()}).on("blur",function(){var e=this;setTimeout(function(){$(e).next(".input-reset-btn").hide()},200)}),$(".input-reset-btn").on("click",function(){$(this).prev("input").val(""),$(this).hide(),$(".input-captcha").removeClass("error")}),$(".clause").on("click",function(){register.clause=!register.clause,$(this).toggleClass("not")}),$(".btn-reset").on("click",this.reCaptcha),$("#goRegisterState").click(function(){if(register.isVerifyIng)return!1;var e=$("#phoneNumber").val(),t=$("#captchaImg").val();if(!e)return talk.tips("regPhoneNull"),!1;if(!t)return talk.tips("regCaptchaNull"),!1;var i=/1[3-8]+\d{9}/;return i.test(e)?(user.phone=e,user.captcha=t,void register.userVerify()):(talk.tips("regPhoneError"),!1)}),$("#goRegisterSuccessState").click(function(){if(register.isRegisterIng)return!1;var e=$("#password").val(),t=$("#captcha").val();return t?e?e.length<6?(talk.tips("regPwMinSize"),!1):register.clause?(user.password=e,user.captcha=t,void register.userRegister()):(talk.tips("regClause"),!1):(talk.tips("regPwNull"),!1):(talk.tips("regPhoneCaptchaNull"),!1)}),$("#loadCaptcha").click(register.loadCaptcha),$(".download-share").click(this.showShare),$("#shareState").click(this.hideShare)},showShare:function(){_paq.push(["trackEvent","7xi","share","start"]),$("#shareState").show()},hideShare:function(){$("#shareState").hide()},loadCaptcha:function(){$("#loadCaptcha img").attr("src","/captcha.jpg?"+Math.random())},userVerify:function(){register.isVerifyIng=1,api("verify",user,function(e){register.isVerifyIng=0,0===e.errorCode?0===e.data.is_bind?register.toStateRegister(e):1===e.data.is_bind?(register.isVerifyIng=1,register.toStateOldSuccess()):2===e.data.is_bind&&($(".input-captcha").addClass("error"),talk.tips("regCaptchaError")):alert(e.errorMessage)})},userRegister:function(){register.isRegisterIng=1,api("register",user,function(e){register.isRegisterIng=0,0===e.errorCode?(register.isRegisterIng=1,register.toStateRegisterSuccess()):talk.tips("regPhoneCaptchaError")})},toStateRegister:function(e){$("#phoneState").hide(),$("#registerState").show(),register.reSendSms($(".btn-reset"),e.data.needWaitTime||60)},toStateRegisterSuccess:function(){api("reward_post",user,function(e){register.isRegisterIng=0,0===e.errorCode?($("#registerState").hide(),$("#registerSuccessState").show()):alert(e.errorMessage)})},toStateOldSuccess:function(){$("#phone").text(user.phone),api("reward_post",user,function(e){register.isVerifyIng=0,0===e.errorCode?($("#phoneState").hide(),$("#moneySuccessState").show()):alert(e.errorMessage)})},reSendSms:function(e,t){register.disBtn(),clearInterval(register.reSendCountDown),register.reSendCountDown=setInterval(function(){e.text("重新获取("+t+")"),t--,0===t&&(clearInterval(register.reSendCountDown),e.text("重新发送"),register.enBtn())},1e3)},disBtn:function(e){this.isReCaptcha=!1},enBtn:function(e){this.isReCaptcha=!0},reCaptcha:function(){return register.isReCaptcha?void api("reCaptcha",user,function(e){0===e.errorCode?register.reSendSms($(".btn-reset"),e.data.needWaitTime||60):alert(e.errorMessage)}):!1}};var register=new registerObj;RewardsObj.prototype={init:function(){this.loadRewardInfo()},loadRewardInfo:function(){var e=this;api("reward",user,function(t){0===t.errorCode?(user=$.extend(user,t.data),e.setText(),e.bind()):alert(t.errorMessage)}),api("user",{is_help:0},function(e){0===e.errorCode?(user=$.extend(user,e.data),setShare(user.uid)):alert(e.errorMessage)})},setText:function(){$("#moneyUsable").text(user.money_usable),$("#moneyUse").text(user.money_use),$("#moneySelf").text(user.money_self),$("#moneyFriend").text(user.money_friend),1===user.is_cash_self?$("#convertSelf").removeClass("use"):$("#convertSelf").addClass("use"),1===user.is_cash_friend?$("#convertFriend").removeClass("use"):$("#convertFriend").addClass("use")},bind:function(){$("#convertSelf").on("click",this.cashMoneySelf),$("#convertFriend").on("click",this.cashMoneyFriend),$("#cashFriendModal .modal-close").on("click",this.closeModal),$("#cashFriendModal .modal-ok").on("click",this.postReward)},closeModal:function(){$("#cashFriendModal").hide()},openModal:function(e){$("#cashFriendModal .modal-body").text(e),$("#cashFriendModal").show()},cashMoneySelf:function(){return user.money_self?(rewards.cashType=1,void(1===user.is_cash_self&&(rewards.cashMoney=user.money_self,user.money_self>user.money_usable?(rewards.cashMoney=user.money_usable,rewards.openModal(talk.get("maxMoney",user.money_usable))):rewards.postReward()))):(talk.tips("notMoneyYou"),!1)},cashMoneyFriend:function(){return user.money_friend?(rewards.cashType=2,void(1===user.is_cash_friend&&(rewards.cashMoney=user.money_friend,user.money_friend>user.money_usable?(rewards.cashMoney=user.money_usable,rewards.openModal(talk.get("maxMoney",user.money_usable))):rewards.postReward()))):(talk.tips("notFriendHelpYou"),!1)},postReward:function(){return window.location.href=talk.url.register+"?cashType="+rewards.cashType,!1},resetMoney:function(){1===this.cashType?user.is_cash_self=0:2===this.cashType&&(user.is_cash_friend=0),user.money_usable-=this.cashMoney,user.money_use+=this.cashMoney,this.setText()}};var rewards=new RewardsObj;RewardsListObj.prototype={init:function(){rewardsList.getUser()},setText:function(){$(".today-data").text(this.getTodayDate()),$(".today-money").text(this.getTotalMoney())},getUser:function(){var e={is_help:1};$("#homeState").length&&(e.is_help=0),api("list",e,function(e){0===e.errorCode?(rewardsList.lists=e.data.list,rewardsList.list(),rewardsList.setText(),$("#todayMoney").text(e.data.score)):alert(e.errorMessage)})},__list:function(){var e="";user.money_self&&(e+=rewardsList.getTpl({picture:user.picture,username:user.username,money:user.money_self,is_self:1})),user.money_self||this.lists.length?user.money_self&&!this.lists.length?e+='<p class="list-null">艰苦奋斗自力更生，没朋友也能活下去</p>':$.each(this.lists,function(t,i){e+=rewardsList.getTpl(i)}):e+='<p class="list-null">您今日尚未获得奖励</p>',$(".user-list").append(e)},list:function(){var e="";this.lists.length?1===this.lists.length&&1===this.lists[0].is_self?(e+=rewardsList.getTpl(this.lists[0]),e+='<p class="list-null">艰苦奋斗自力更生，没朋友也能活下去</p>'):$.each(this.lists,function(t,i){e+=rewardsList.getTpl(i)}):e+='<p class="list-null">您今日尚未获得奖励</p>',$(".user-list").append(e)},getTpl:function(e){return'<li class="user-item"><div class="picture pull-left"><img src="'+(e.picture?e.picture:"./res/share.png")+'"></div><div class="username pull-left">'+(e.username?e.username:"未知")+'</div><div class="help-money pull-right">'+(e.is_self?"自立更生赚":"帮我赚")+"<span>"+e.money+"</span>元</div></li>"},getTotalMoney:function(){var e=0;return $.each(this.lists,function(t,i){e+=i.money}),e},getTodayDate:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,s=e.getDate();return t+"年"+i+"月"+s+"日"}};var rewardsList=new RewardsListObj;!function(){if($("#game").length){var e=window.innerWidth,t=window.innerHeight;gigoloKnit.GAME_WIDTH=1080,gigoloKnit.GAME_HEIGHT=t/e*1080,gigoloKnit.BACKGROUND="#F7E6B3";var i=new Phaser.Game(gigoloKnit.GAME_WIDTH,gigoloKnit.GAME_HEIGHT,Phaser.CANVAS,"game");i.cache=!1,i.state.add("boot",gigoloKnit.boot),i.state.add("preloader",gigoloKnit.preloader),i.state.add("menu",gigoloKnit.menu),i.state.add("game",gigoloKnit.game),i.state.add("scoreState",gigoloKnit.scoreState),i.state.add("readyGo",gigoloKnit.readyGo),i.state.add("ruleGame",gigoloKnit.ruleGame),i.state.start("boot")}else $("#homeState").length?home.init():$("#moneyState").length?rewards.init():$("#listState").length?rewardsList.init():$("#registerState").length&&register.init()}();
//# sourceMappingURL=app.min.js.map